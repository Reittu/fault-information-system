{"version":3,"sources":["actions/index.ts","components/ToolGroup.tsx","components/ToolDrawer.tsx","components/AutosuggestWrapper.tsx","components/CustomAppBar.tsx","utils/fetch.ts","components/ReportDialog.tsx","components/UserDialog.tsx","components/CustomMarker.tsx","components/CustomSnackbar.tsx","utils/markers.ts","App.tsx","reducers/drawer.ts","reducers/viewport.ts","reducers/tool.ts","reducers/markers.ts","reducers/snackbar.ts","reducers/spinner.ts","reducers/user.ts","reducers/dialog.ts","reducers/index.ts","store.ts","index.tsx"],"names":["setViewport","payload","type","setReportDialog","setUserDialog","setMarkers","setSnackbar","setUser","useStyles","makeStyles","theme","buttonGroup","flexDirection","toggleButton","justifyContent","textTransform","listIcon","minWidth","padding","marginRight","ToolGroup","classes","tool","useSelector","state","dispatch","useDispatch","ToggleButtonGroup","className","size","value","exclusive","onChange","e","val","ToggleButton","title","Typography","variant","Button","onClick","navigator","geolocation","getCurrentPosition","pos","coords","longitude","latitude","zoom","bearing","pitch","alert","drawer","width","drawerWidth","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","spacing","breakpoints","up","toolbar","display","alignItems","mixins","ToolDrawer","useTheme","drawerIsOpen","Drawer","clsx","paper","IconButton","data-testid","direction","debounceTimer","MAPBOX_TOKEN","process","searchIcon","position","top","transform","autosuggest","margin","paddingTop","paddingBottom","borderColor","paddingLeft","color","getSuggestions","a","inputValue","trim","toLowerCase","length","queryPlaces","query","fetch","response","json","data","features","AutosuggestWrapper","useState","suggestions","setSuggestions","setValue","viewport","useEffect","clearTimeout","window","setTimeout","Autocomplete","freeSolo","onInputChange","event","newValue","options","renderInput","params","TextField","label","getOptionLabel","option","place_name","renderOption","Number","center","appBar","zIndex","appBarShift","marginLeft","menuButton","hide","opacity","searchBox","SearchAppBar","user","AppBar","Toolbar","aria-label","edge","noWrap","aria-haspopup","open","mode","fetchOptions","method","bodyData","headers","body","JSON","stringify","fetchBase","inputData","result","parse","message","recordset","isNaN","Error","apiQueryUrl","placeDataArray","filter","feature","place_type","split","city","region","country","addressDataArray","address","postcodeDataArray","postcode","text","ReportDialog","reportDialog","markers","subject","setSubject","description","setDescription","editForm","useRef","handleClose","requestSubmit","current","handleSubmit","preventDefault","newMarkers","map","marker","i","markerIndex","reporter","dbIndex","id","updateReport","then","severity","catch","err","finally","insertReport","Dialog","onEnter","onClose","aria-labelledby","DialogTitle","DialogContent","Box","pb","mb","ref","onSubmit","disabled","style","all","autoFocus","fullWidth","target","inputProps","minLength","maxLength","required","multiline","rows","DialogActions","marginTop","avatar","backgroundColor","palette","secondary","main","form","submit","handleSetup","UserDialog","userDialog","loginUsername","setLoginUsername","loginPassword","setLoginPassword","registerName","setRegisterName","registerUsername","setRegisterUsername","registerEmail","setRegisterEmail","registerPassword","setRegisterPassword","forgotUsername","setForgotUsername","passwordValidator","pwPattern","toString","slice","invalidPwMessage","switchToRegister","switchToLogin","switchToForgot","switchToLogout","handleRegister","Auth","signUp","username","password","attributes","email","name","signUpResponse","console","log","handleLogin","signIn","code","prompt","confirmSignUp","handleForgot","forgotPassword","newPassword","test","forgotPasswordSubmit","handleLogout","signOut","registerContent","Avatar","component","autoComplete","pattern","Grid","container","justify","item","Link","href","loginContent","FormControlLabel","control","Checkbox","xs","logoutContent","forgotContent","Container","maxWidth","CustomMarker","props","offsetLeft","offsetTop","localIndex","fontWeight","cursor","deleteMarkerLocally","confirm","deleteReport","Alert","elevation","CustomSnackbar","snackbar","reason","Snackbar","autoHideDuration","addNewMarkerLocally","reverseGeocode","res","newMarker","initialTheme","primary","purple","blue","root","content","flexGrow","height","overflow","addToolSelected","App","muiTheme","createMuiTheme","spinner","getAllReports","reports","handleClick","tagName","lngLat","ThemeProvider","CssBaseline","mapStyle","onViewportChange","mapboxApiAccessToken","onMouseDown","useMemo","m","key","CircularProgress","left","drawerReducer","action","initialState","viewportReducer","toolReducer","markerReducer","undefined","snackbarReducer","spinnerReducer","userReducer","reportDialogInitialState","userDialogInitialState","allReducers","combineReducers","store","createStore","Amplify","configure","mandatorySignIn","userPoolId","userPoolWebClientId","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.69250246.chunk.js","sourcesContent":["import { Action } from 'redux';\r\nimport { ReportDialog, UserDialog, Marker, Tool, Viewport, PayloadAction, Snackbar, User } from '../types';\r\n\r\nexport const openDrawer = (): Action => ({ type: 'OPEN-DRAWER' });\r\nexport const closeDrawer = (): Action => ({ type: 'CLOSE-DRAWER' });\r\nexport const showSpinner = (): Action => ({ type: 'SHOW-SPINNER' });\r\nexport const hideSpinner = (): Action => ({ type: 'HIDE-SPINNER' });\r\n\r\nexport const setTool = (payload: Tool): PayloadAction<Tool> => {\r\n    return {\r\n        type: 'TOOL',\r\n        payload\r\n    }\r\n};\r\n\r\nexport const setViewport = (payload: Viewport): PayloadAction<Viewport> => {\r\n    return {\r\n        type: 'VIEWPORT',\r\n        payload\r\n    }\r\n};\r\n\r\nexport const setReportDialog = (payload: ReportDialog): PayloadAction<ReportDialog> => {\r\n    return {\r\n        type: 'REPORT-DIALOG',\r\n        payload\r\n    }\r\n};\r\n\r\nexport const setUserDialog = (payload: UserDialog): PayloadAction<UserDialog> => {\r\n    return {\r\n        type: 'USER-DIALOG',\r\n        payload\r\n    }\r\n};\r\n\r\nexport const setMarkers = (payload: Marker[]): PayloadAction<Marker[]> => {\r\n    return {\r\n        type: 'MARKERS',\r\n        payload\r\n    }\r\n};\r\n\r\nexport const setSnackbar = (payload: Snackbar): PayloadAction<Snackbar> => {\r\n    return {\r\n        type: 'SNACKBAR',\r\n        payload\r\n    }\r\n};\r\n\r\nexport const setUser = (payload: User): PayloadAction<User> => {\r\n    return {\r\n        type: 'USER',\r\n        payload\r\n    }\r\n};","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Typography from '@material-ui/core/Typography'\r\nimport ToggleButton from '@material-ui/lab/ToggleButton';\r\nimport ToggleButtonGroup from '@material-ui/lab/ToggleButtonGroup';\r\nimport Button from '@material-ui/core/Button';\r\nimport AddLocationIcon from '@material-ui/icons/AddLocation';\r\nimport EditLocationIcon from '@material-ui/icons/EditLocation';\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport MyLocationIcon from '@material-ui/icons/MyLocation';\r\nimport NotListedLocationIcon from '@material-ui/icons/NotListedLocation';\r\n\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setTool, setViewport } from '../actions';\r\nimport { RootState } from '../reducers';\r\nimport { Tool } from '../types';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    buttonGroup: {\r\n        flexDirection: 'column'\r\n    },\r\n    toggleButton: {\r\n        justifyContent: 'flex-start',\r\n        textTransform: 'none'\r\n    },\r\n    listIcon: {\r\n        minWidth: '56px',\r\n        padding: '0 16px',\r\n        marginRight: '12px'\r\n    }\r\n}));\r\n\r\nexport default function ToolGroup() {\r\n    const classes = useStyles();\r\n    const tool = useSelector((state: RootState) => state.tool);\r\n    const dispatch = useDispatch();\r\n\r\n    const handleChange = (e: any, val: Tool) => dispatch(setTool(val));\r\n\r\n    const centerGPS = () => {\r\n        if (!navigator.geolocation) {\r\n            alert('Your browser does not support GeoLocation.');\r\n        } else {\r\n            navigator.geolocation.getCurrentPosition(pos => {\r\n                if (pos.coords) {\r\n                    dispatch(setViewport({\r\n                        longitude: pos.coords.longitude,\r\n                        latitude: pos.coords.latitude,\r\n                        zoom: 16,\r\n                        bearing: 0,\r\n                        pitch: 0,\r\n                    }))\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <ToggleButtonGroup className={classes.buttonGroup} size='small' value={tool} exclusive onChange={handleChange}>\r\n                <ToggleButton className={classes.toggleButton} value='add' title='Report new faults'>\r\n                    <AddLocationIcon className={classes.listIcon} />\r\n                    <Typography variant='body1'>Report a new fault</Typography>\r\n                </ToggleButton>\r\n                <ToggleButton className={classes.toggleButton} value='edit' title='Edit existing faults'>\r\n                    <EditLocationIcon className={classes.listIcon} />\r\n                    <Typography variant='body1'>Edit submitted faults</Typography>\r\n                </ToggleButton>\r\n                <ToggleButton className={classes.toggleButton} value='delete' title='Remove faults'>\r\n                    <DeleteIcon className={classes.listIcon} />\r\n                    <Typography variant='body1'>Delete faults</Typography>\r\n                </ToggleButton>\r\n                <ToggleButton className={classes.toggleButton} value='review' title='Review faults in detail'>\r\n                    <NotListedLocationIcon className={classes.listIcon} />\r\n                    <Typography variant='body1'>Review faults</Typography>\r\n                </ToggleButton>\r\n            </ToggleButtonGroup>\r\n            <Button className={classes.toggleButton} onClick={centerGPS} title='Center map to your location'>\r\n                <MyLocationIcon className={classes.listIcon} />\r\n                <Typography variant='body1'>Center to your location</Typography>\r\n            </Button>\r\n        </>\r\n    );\r\n}","import React from 'react';\r\nimport clsx from 'clsx';\r\nimport { makeStyles, useTheme } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport ToolGroup from './ToolGroup';\r\nimport { drawerWidth } from '../App';\r\n\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { closeDrawer } from '../actions';\r\nimport { RootState } from '../reducers';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n    drawer: {\r\n        width: drawerWidth,\r\n        flexShrink: 0,\r\n        whiteSpace: 'nowrap',\r\n    },\r\n    drawerOpen: {\r\n        width: drawerWidth,\r\n    },\r\n    drawerClose: {\r\n        overflowX: 'hidden',\r\n        width: theme.spacing(7) + 1,\r\n        [theme.breakpoints.up('sm')]: {\r\n            width: theme.spacing(9) + 1,\r\n        },\r\n    },\r\n    toolbar: {\r\n        display: 'flex',\r\n        alignItems: 'center',\r\n        justifyContent: 'flex-end',\r\n        padding: theme.spacing(0, 1),\r\n        ...theme.mixins.toolbar,\r\n    },\r\n    buttonGroup: {\r\n        flexDirection: 'column'\r\n    },\r\n    toggleButton: {\r\n        justifyContent: 'flex-start',\r\n        textTransform: 'none'\r\n    },\r\n    listIcon: {\r\n        minWidth: '56px',\r\n        padding: '0 16px',\r\n        marginRight: '12px'\r\n    }\r\n}));\r\n\r\nexport default function ToolDrawer() {\r\n    const classes = useStyles();\r\n    const theme = useTheme();\r\n\r\n    const drawerIsOpen = useSelector((state: RootState) => state.drawerIsOpen);\r\n    const dispatch = useDispatch();\r\n\r\n    return (\r\n        <Drawer\r\n            variant='permanent'\r\n            className={clsx(classes.drawer, {\r\n                [classes.drawerOpen]: drawerIsOpen,\r\n                [classes.drawerClose]: !drawerIsOpen,\r\n            })}\r\n            classes={{\r\n                paper: clsx({\r\n                    [classes.drawerOpen]: drawerIsOpen,\r\n                    [classes.drawerClose]: !drawerIsOpen,\r\n                }),\r\n            }}\r\n        >\r\n            <div className={classes.toolbar}>\r\n                <IconButton onClick={() => dispatch(closeDrawer())} data-testid='drawer-button'>\r\n                    {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n                </IconButton>\r\n            </div>\r\n            <ToolGroup />\r\n        </Drawer>\r\n\r\n    );\r\n}","import React, { useState, useEffect } from 'react';\r\nimport { TextField, makeStyles } from '@material-ui/core';\r\nimport { Autocomplete } from '@material-ui/lab';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setViewport } from '../actions';\r\nimport { RootState } from '../reducers';\r\nimport { GeoJSONFeature, GeoJSONFeatureCollection } from '../types';\r\n\r\nconst MAPBOX_TOKEN = process.env.REACT_APP_MAPBOX_TOKEN;\r\nlet debounceTimer: number;\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  searchIcon: {\r\n    position: 'absolute',\r\n    top: '50%',\r\n    transform: 'translate(50%, -50%)'\r\n  },\r\n  autosuggest: {\r\n    '& .MuiFormControl-root': {\r\n      margin: '0 0 0 5px'\r\n    },\r\n    '& .MuiInputBase-root': {\r\n      paddingTop: 0,\r\n      paddingBottom: 0\r\n    },\r\n    '& .Mui-focused .MuiOutlinedInput-notchedOutline': {\r\n      borderColor: '#fff'\r\n    },\r\n    '& .MuiAutocomplete-inputRoot': {\r\n      paddingLeft: '32px',\r\n      color: '#fff'\r\n    },\r\n    '& .MuiInputLabel-root': {\r\n      transform: 'translate(36px, 12px) scale(1)',\r\n      padding: 0,\r\n      color: '#fff'\r\n    },\r\n    '& .MuiInputLabel-shrink': {\r\n      transform: 'translate(14px, -6px) scale(0.75)'\r\n    },\r\n  }\r\n}));\r\n\r\nconst getSuggestions = async (value: string) => {\r\n  const inputValue = value.trim().toLowerCase();\r\n  return inputValue.length < 2 ? [] : queryPlaces(value);\r\n};\r\n\r\nasync function queryPlaces(query: string) {\r\n  const response = await fetch(\r\n    'https://api.mapbox.com/geocoding/v5/mapbox.places/' +\r\n      query +\r\n      '.json?access_token=' +\r\n      MAPBOX_TOKEN\r\n  );\r\n  const data: GeoJSONFeatureCollection = await response.json();\r\n  return data.features || [];\r\n}\r\n\r\nfunction AutosuggestWrapper() {\r\n  const classes = useStyles();\r\n  const [suggestions, setSuggestions] = useState<GeoJSONFeature[]>([]);\r\n  const [value, setValue] = useState('');\r\n\r\n  const viewport = useSelector((state: RootState) => state.viewport);\r\n  const dispatch = useDispatch();\r\n\r\n  useEffect(() => {\r\n    async function asyncSet() {\r\n      setSuggestions(await getSuggestions(value));\r\n    }\r\n    clearTimeout(debounceTimer);\r\n    debounceTimer = window.setTimeout(asyncSet, 300);\r\n  }, [value]);\r\n\r\n  return (\r\n    <>\r\n      <SearchIcon className={classes.searchIcon} />\r\n      <Autocomplete\r\n        className={classes.autosuggest}\r\n        freeSolo\r\n        onInputChange={(event, newValue) => setValue(newValue)}\r\n        options={suggestions}\r\n        renderInput={(params) => (\r\n          <TextField\r\n            {...params}\r\n            label=\"Search for a location...\"\r\n            margin=\"normal\"\r\n            variant=\"outlined\"\r\n          />\r\n        )}\r\n        getOptionLabel={(option) => option.place_name}\r\n        renderOption={(option) => {\r\n          return (\r\n            <div\r\n              onClick={() => {\r\n                dispatch(\r\n                  setViewport({\r\n                    ...viewport,\r\n                    longitude: Number(option.center[0]),\r\n                    latitude: Number(option.center[1]),\r\n                    zoom: 16\r\n                  })\r\n                );\r\n              }}\r\n            >\r\n              {option.place_name}\r\n            </div>\r\n          );\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default AutosuggestWrapper;\r\n","import React from 'react';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport AccountCircle from '@material-ui/icons/AccountCircle';\r\nimport clsx from 'clsx';\r\nimport AutosuggestWrapper from './AutosuggestWrapper';\r\nimport { drawerWidth } from '../App';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { openDrawer, closeDrawer, setUserDialog } from '../actions';\r\nimport { RootState } from '../reducers';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`\r\n  },\r\n  menuButton: {\r\n    marginRight: 36\r\n  },\r\n  hide: {\r\n    opacity: 0.5\r\n  },\r\n  searchBox: {\r\n    width: '300px'\r\n  },\r\n  toolbar: {\r\n    justifyContent: 'space-between'\r\n  }\r\n}));\r\n\r\nexport default function SearchAppBar() {\r\n  const classes = useStyles();\r\n  const drawerIsOpen = useSelector((state: RootState) => state.drawerIsOpen);\r\n  const user = useSelector((state: RootState) => state.user);\r\n  const dispatch = useDispatch();\r\n\r\n  return (\r\n    <AppBar\r\n      position=\"fixed\"\r\n      className={clsx(classes.appBar, {\r\n        [classes.appBarShift]: drawerIsOpen\r\n      })}\r\n    >\r\n      <Toolbar className={classes.toolbar}>\r\n        <IconButton\r\n          color=\"inherit\"\r\n          aria-label=\"open drawer\"\r\n          onClick={drawerIsOpen ? () => dispatch(closeDrawer()) : () => dispatch(openDrawer())}\r\n          edge=\"start\"\r\n          className={clsx(classes.menuButton, {\r\n            [classes.hide]: drawerIsOpen\r\n          })}\r\n        >\r\n          <MenuIcon />\r\n        </IconButton>\r\n        <Typography variant=\"h6\" noWrap>\r\n          Fault Information System\r\n        </Typography>\r\n        <div className={classes.searchBox}>\r\n          <AutosuggestWrapper />\r\n        </div>\r\n        <IconButton\r\n          edge=\"end\"\r\n          aria-label=\"account of current user\"\r\n          aria-haspopup=\"true\"\r\n          onClick={() => dispatch(setUserDialog({ open: true, mode: user === null ? 'login' : 'logout' }))}\r\n          color=\"inherit\"\r\n        >\r\n          <AccountCircle />\r\n        </IconButton>\r\n      </Toolbar>\r\n    </AppBar>\r\n  );\r\n}\r\n","import {\r\n  HTTPMethod,\r\n  ReportBodyInsert,\r\n  ReportBodyUpdate,\r\n  ReportBodyDelete,\r\n  QueryGetResult,\r\n  QuerySetResult,\r\n  GeoJSONFeatureCollection\r\n} from '../types';\r\n\r\nconst API_URL = 'https://ey86blceac.execute-api.us-east-1.amazonaws.com/prod/reports';\r\n\r\nconst fetchOptions = (\r\n  method: HTTPMethod,\r\n  bodyData?: ReportBodyInsert | ReportBodyUpdate | ReportBodyDelete\r\n) => ({\r\n  method,\r\n  headers: {\r\n    'Content-Type': 'application/json'\r\n  },\r\n  body: JSON.stringify(bodyData)\r\n});\r\n\r\nconst fetchBase = async (\r\n  method: HTTPMethod,\r\n  inputData?: ReportBodyInsert | ReportBodyUpdate | ReportBodyDelete\r\n) => {\r\n  const result = await fetch(API_URL, fetchOptions(method, inputData));\r\n  const json = await result.json();\r\n  return JSON.parse(json.body).message;\r\n};\r\n\r\nexport async function getAllReports() {\r\n  const result: QueryGetResult = await fetchBase('GET');\r\n  return result.recordset;\r\n}\r\n\r\nexport async function insertReport(data: ReportBodyInsert) {\r\n  const result: QuerySetResult = await fetchBase('POST', data);\r\n  if (isNaN(result.recordset[0].result as any))\r\n    throw Error('Failed to insert: ' + result.recordset[0].result);\r\n  return result.recordset[0].result;\r\n}\r\n\r\nexport async function updateReport(data: ReportBodyUpdate) {\r\n  const result: QuerySetResult = await fetchBase('PUT', data);\r\n  if (result.recordset[0].result !== 'Success')\r\n    throw Error('Failed to update: ' + result.recordset[0].result);\r\n  return result.recordset[0].result;\r\n}\r\n\r\nexport async function deleteReport(data: ReportBodyDelete) {\r\n  const result: QuerySetResult = await fetchBase('DELETE', data);\r\n  if (result.recordset[0].result !== 'Success')\r\n    throw Error('Failed to delete: ' + result.recordset[0].result);\r\n  return result.recordset[0].result;\r\n}\r\n\r\nexport async function reverseGeocode(apiQueryUrl: string) {\r\n  const result = await fetch(apiQueryUrl);\r\n  const json: GeoJSONFeatureCollection = await result.json();\r\n\r\n  let city, region, country, address, postcode;\r\n\r\n  const placeDataArray = json.features.filter((feature) => feature.place_type[0] === 'place');\r\n  if (placeDataArray.length > 0) [city, region, country] = placeDataArray[0].place_name.split(', ');\r\n\r\n  const addressDataArray = json.features.filter((feature) => feature.place_type[0] === 'address');\r\n  if (addressDataArray.length > 0) address = addressDataArray[0].place_name.split(', ')[0];\r\n\r\n  const postcodeDataArray = json.features.filter((feature) => feature.place_type[0] === 'postcode');\r\n  if (postcodeDataArray.length > 0) postcode = postcodeDataArray[0].text;\r\n\r\n  return { city, region, country, address, postcode };\r\n}\r\n","import React, { useState, useRef, SyntheticEvent } from 'react';\r\nimport Box from '@material-ui/core/Box';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport DialogActions from '@material-ui/core/DialogActions';\r\nimport DialogContent from '@material-ui/core/DialogContent';\r\nimport DialogTitle from '@material-ui/core/DialogTitle';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setMarkers, setSnackbar, showSpinner, hideSpinner, setReportDialog } from '../actions';\r\nimport { insertReport, updateReport } from '../utils/fetch';\r\nimport { Marker } from '../types';\r\nimport { RootState } from '../reducers';\r\n\r\nexport default function ReportDialog() {\r\n  const reportDialog = useSelector((state: RootState) => state.reportDialog);\r\n  const tool = useSelector((state: RootState) => state.tool);\r\n  const markers = useSelector((state: RootState) => state.markers);\r\n  const [subject, setSubject] = useState('');\r\n  const [description, setDescription] = useState('');\r\n  const dispatch = useDispatch();\r\n  const editForm = useRef<HTMLFormElement>(null);\r\n\r\n  const handleSetup = () => {\r\n    setSubject(reportDialog.subject);\r\n    setDescription(reportDialog.description);\r\n  };\r\n  const handleClose = () => dispatch(setReportDialog({...reportDialog, open: false}));\r\n\r\n  const requestSubmit = () => {\r\n    editForm.current?.requestSubmit(); // Validate form and submit\r\n  };\r\n\r\n  const handleSubmit = (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n\r\n    const newMarkers = markers.map((marker: Marker, i: number) => {\r\n      // Find the marker that initiated the edit dialog\r\n      if (i === reportDialog.markerIndex) {\r\n        const { latitude, longitude, city, postcode, address, reporter, id: dbIndex } = marker;\r\n        dispatch(showSpinner());\r\n        if (dbIndex) {\r\n          // Marker already has an associated database id: wanted action is update\r\n          updateReport({ id: dbIndex, subject, description })\r\n            .then(() => {\r\n              dispatch(\r\n                setSnackbar({\r\n                  message: 'Report updated.',\r\n                  open: true,\r\n                  severity: 'success'\r\n                })\r\n              );\r\n            })\r\n            .catch((err) =>\r\n              dispatch(\r\n                setSnackbar({\r\n                  message: err.message,\r\n                  open: true,\r\n                  severity: 'error'\r\n                })\r\n              )\r\n            )\r\n            .finally(() => dispatch(hideSpinner()));\r\n        } else {\r\n          // Marker has no existing database id: wanted action is insert\r\n          insertReport({\r\n            subject,\r\n            description,\r\n            latitude,\r\n            longitude,\r\n            city,\r\n            postcode,\r\n            address,\r\n            reporter\r\n          })\r\n            .then((result) => {\r\n              let newMarkers = [...markers];\r\n              newMarkers[i].id = Number(result);\r\n              newMarkers[i].subject = subject;\r\n              newMarkers[i].description = description;\r\n              dispatch(setMarkers(newMarkers));\r\n              dispatch(\r\n                setSnackbar({\r\n                  message: 'Report posted.',\r\n                  open: true,\r\n                  severity: 'success'\r\n                })\r\n              );\r\n            })\r\n            .catch((err) =>\r\n              dispatch(\r\n                setSnackbar({\r\n                  message: err.message,\r\n                  open: true,\r\n                  severity: 'error'\r\n                })\r\n              )\r\n            )\r\n            .finally(() => dispatch(hideSpinner()));\r\n        }\r\n        return { ...marker, subject, description };\r\n      } else return marker;\r\n    });\r\n\r\n    dispatch(setMarkers(newMarkers));\r\n    handleClose();\r\n  };\r\n\r\n  const reviewModeContent = () => (\r\n    <>\r\n      <DialogTitle id=\"form-dialog-title\">{subject}</DialogTitle>\r\n      <DialogContent>\r\n        <Box color=\"text.secondary\" pb=\"16px\">\r\n          <Box mb=\"16px\">\r\n            <Typography display=\"inline\">Reported by: </Typography>\r\n            <Typography display=\"inline\" color=\"primary\">\r\n              {reportDialog.reporter}\r\n            </Typography>\r\n          </Box>\r\n          <Box mb=\"16px\">\r\n            <Typography>\r\n              {reportDialog.address}, {reportDialog.postcode}, {reportDialog.city}\r\n            </Typography>\r\n            <Typography>Latitude: {reportDialog.latitude}</Typography>\r\n            <Typography>Longitude: {reportDialog.longitude}</Typography>\r\n          </Box>\r\n          <Typography color=\"textPrimary\">{description}</Typography>\r\n        </Box>\r\n      </DialogContent>\r\n    </>\r\n  );\r\n\r\n  const nonReviewModeContent = () => (\r\n    <>\r\n      <DialogTitle id=\"form-dialog-title\">Fault Details</DialogTitle>\r\n      <DialogContent>\r\n        <Box color=\"text.secondary\" mb=\"16px\">\r\n          <Box mb=\"8px\">\r\n            <Typography color=\"textSecondary\" display=\"inline\">\r\n              Reported by: \r\n            </Typography>\r\n            <Typography color=\"primary\" display=\"inline\">\r\n              {reportDialog.reporter}\r\n            </Typography>\r\n          </Box>\r\n          <Typography>\r\n            Set a subject text that appears in the map and a more in-depth description of the issue.\r\n          </Typography>\r\n        </Box>\r\n        <form ref={editForm} onSubmit={handleSubmit}>\r\n          <fieldset\r\n            disabled={reportDialog.reporter !== 'guest' ? true : false}\r\n            style={{ all: 'unset' }}\r\n          >\r\n            <TextField\r\n              autoFocus\r\n              margin=\"dense\"\r\n              id=\"subject\"\r\n              label=\"Subject\"\r\n              type=\"text\"\r\n              fullWidth\r\n              value={subject}\r\n              onChange={(e) => setSubject(e.target.value)}\r\n              inputProps={{ minLength: 3, maxLength: 50 }}\r\n              required\r\n            />\r\n            <TextField\r\n              margin=\"dense\"\r\n              id=\"description\"\r\n              label=\"Description\"\r\n              type=\"text\"\r\n              fullWidth\r\n              value={description}\r\n              onChange={(e) => setDescription(e.target.value)}\r\n              inputProps={{ minLength: 5, maxLength: 500 }}\r\n              multiline={true}\r\n              rows=\"2\"\r\n              required\r\n            />\r\n            <input type=\"submit\" style={{ display: 'none' }} />\r\n          </fieldset>\r\n        </form>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={handleClose} color=\"primary\">\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          onClick={requestSubmit}\r\n          color=\"primary\"\r\n          disabled={reportDialog.reporter !== 'guest' ? true : false}\r\n        >\r\n          Save\r\n        </Button>\r\n      </DialogActions>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <Dialog\r\n      onEnter={handleSetup}\r\n      open={reportDialog.open}\r\n      onClose={() => handleClose()}\r\n      aria-labelledby=\"form-dialog-title\"\r\n    >\r\n      {tool === 'review' ? reviewModeContent() : nonReviewModeContent()}\r\n    </Dialog>\r\n  );\r\n}\r\n","import React, { useState, SyntheticEvent } from 'react';\r\nimport Button from '@material-ui/core/Button';\r\nimport TextField from '@material-ui/core/TextField';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Link from '@material-ui/core/Link';\r\nimport Dialog from '@material-ui/core/Dialog';\r\nimport Grid from '@material-ui/core/Grid';\r\nimport Container from '@material-ui/core/Container';\r\nimport LockOutlinedIcon from '@material-ui/icons/LockOutlined';\r\nimport LockOpenOutlinedIcon from '@material-ui/icons/LockOpenOutlined';\r\nimport PermIdentityOutlinedIcon from '@material-ui/icons/PermIdentityOutlined';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setUserDialog, setUser } from '../actions';\r\nimport { RootState } from '../reducers';\r\nimport Auth from '@aws-amplify/auth';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  paper: {\r\n    marginTop: theme.spacing(8),\r\n    display: 'flex',\r\n    flexDirection: 'column',\r\n    alignItems: 'center',\r\n    paddingBottom: '15px'\r\n  },\r\n  avatar: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: theme.palette.secondary.main\r\n  },\r\n  form: {\r\n    width: '100%', // Fix IE 11 issue.\r\n    marginTop: theme.spacing(1)\r\n  },\r\n  submit: {\r\n    margin: theme.spacing(3, 0, 2)\r\n  }\r\n}));\r\n\r\nconst handleSetup = () => undefined;\r\n\r\nexport default function UserDialog() {\r\n  const classes = useStyles();\r\n  const dispatch = useDispatch();\r\n  const userDialog = useSelector((state: RootState) => state.userDialog);\r\n  const user = useSelector((state: RootState) => state.user);\r\n\r\n  const [loginUsername, setLoginUsername] = useState('');\r\n  const [loginPassword, setLoginPassword] = useState('');\r\n  const [registerName, setRegisterName] = useState('');\r\n  const [registerUsername, setRegisterUsername] = useState('');\r\n  const [registerEmail, setRegisterEmail] = useState('');\r\n  const [registerPassword, setRegisterPassword] = useState('');\r\n  const [forgotUsername, setForgotUsername] = useState('');\r\n\r\n  // At least one number, lower case, upper case and a special character. Min length 8, max 255.\r\n  const passwordValidator = /(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[$^*.[\\]{}()?'\"!@#%&/\\\\,><:;|_~`]).{8,255}/;\r\n  const pwPattern = passwordValidator.toString().slice(1, -1);\r\n  const invalidPwMessage =\r\n    'Password should be at least 8 characters long and have at least one lower case, upper case, special character and a number.';\r\n\r\n  const handleClose = () => dispatch(setUserDialog({ ...userDialog, open: false }));\r\n  const switchToRegister = () => dispatch(setUserDialog({ mode: 'register', open: true }));\r\n  const switchToLogin = () => dispatch(setUserDialog({ mode: 'login', open: true }));\r\n  const switchToForgot = () => dispatch(setUserDialog({ mode: 'forgot', open: true }));\r\n  const switchToLogout = () => dispatch(setUserDialog({ mode: 'logout', open: true }));\r\n\r\n  // Placeholder prompts and alerts in place for now before transitioning to custom forms and snackbars.\r\n\r\n  const handleRegister = async (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      const signUpResponse = await Auth.signUp({\r\n        username: registerUsername,\r\n        password: registerPassword,\r\n        attributes: {\r\n          email: registerEmail,\r\n          name: registerName\r\n        }\r\n      });\r\n      console.log(signUpResponse);\r\n    } catch (err) {\r\n      console.log(err);\r\n    }\r\n    switchToLogin();\r\n  };\r\n\r\n  const handleLogin = async (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      const user = await Auth.signIn(loginUsername, loginPassword);\r\n      console.log(user);\r\n      switchToLogout();\r\n      dispatch(setUser(user.username));\r\n    } catch (err) {\r\n      console.log(err);\r\n      if (err.name === 'UserNotConfirmedException') {\r\n        try {\r\n          const code = window.prompt('Type your confirmation code: ');\r\n          if (!code) return;\r\n          await Auth.confirmSignUp(loginUsername, code);\r\n          console.log('Successfully confirmed user');\r\n          switchToLogout();\r\n        } catch (err) {\r\n          alert(err.message);\r\n          console.log('Error confirming sign up', err);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleForgot = async (e: SyntheticEvent) => {\r\n    e.preventDefault();\r\n    try {\r\n      await Auth.forgotPassword(forgotUsername);\r\n\r\n      // Placeholder prompts before another form\r\n      const code = prompt('Type your confirmation code: ');\r\n      if (!code) return;\r\n\r\n      const newPassword = prompt('Type a new password: ');\r\n      if (!newPassword || !passwordValidator.test(newPassword))\r\n        return alert('This password does not meet the requirements.');\r\n\r\n      await Auth.forgotPasswordSubmit(forgotUsername, code, newPassword);\r\n      console.log('Successfully set a new password');\r\n\r\n    } catch (err) {\r\n      alert(err.message);\r\n    }\r\n    switchToLogin();\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    try {\r\n      Auth.signOut();\r\n      console.log('Logged out');\r\n      dispatch(setUser(null));\r\n      switchToLogin();\r\n    } catch (err) {\r\n      alert(err.message);\r\n    }\r\n  };\r\n\r\n  const renderContent = () => {\r\n    if (userDialog.mode === 'register') return registerContent();\r\n    else if (userDialog.mode === 'login') return loginContent();\r\n    else if (userDialog.mode === 'forgot') return forgotContent();\r\n    else if (userDialog.mode === 'logout') return logoutContent();\r\n  };\r\n\r\n  const registerContent = () => (\r\n    <>\r\n      <Avatar className={classes.avatar}>\r\n        <LockOutlinedIcon />\r\n      </Avatar>\r\n      <Typography component=\"h1\" variant=\"h5\">\r\n        Sign up\r\n      </Typography>\r\n      <form\r\n        id=\"register-form\"\r\n        className={classes.form}\r\n        onSubmit={handleRegister}\r\n        autoComplete=\"off\"\r\n      >\r\n        <TextField\r\n          variant=\"outlined\"\r\n          margin=\"normal\"\r\n          required\r\n          fullWidth\r\n          label=\"Full Name\"\r\n          name=\"name\"\r\n          id=\"register-name\"\r\n          autoFocus\r\n          autoComplete=\"name\"\r\n          inputProps={{ minLength: 5, maxLength: 70 }}\r\n          value={registerName}\r\n          onChange={(e) => setRegisterName(e.target.value)}\r\n        />\r\n        <TextField\r\n          variant=\"outlined\"\r\n          margin=\"normal\"\r\n          required\r\n          fullWidth\r\n          label=\"Username\"\r\n          name=\"username\"\r\n          id=\"register-username\"\r\n          autoComplete=\"username\"\r\n          inputProps={{ minLength: 3, maxLength: 50 }}\r\n          value={registerUsername}\r\n          onChange={(e) => setRegisterUsername(e.target.value)}\r\n        />\r\n        <TextField\r\n          variant=\"outlined\"\r\n          margin=\"normal\"\r\n          required\r\n          fullWidth\r\n          name=\"email\"\r\n          label=\"Email Address\"\r\n          type=\"email\"\r\n          id=\"register-email\"\r\n          autoComplete=\"email\"\r\n          inputProps={{ minLength: 5, maxLength: 255 }}\r\n          value={registerEmail}\r\n          onChange={(e) => setRegisterEmail(e.target.value)}\r\n        />\r\n        <TextField\r\n          variant=\"outlined\"\r\n          margin=\"normal\"\r\n          required\r\n          fullWidth\r\n          name=\"password\"\r\n          label=\"Password\"\r\n          type=\"password\"\r\n          id=\"register-password\"\r\n          autoComplete=\"new-password\"\r\n          inputProps={{ pattern: pwPattern, title: invalidPwMessage }}\r\n          value={registerPassword}\r\n          onChange={(e) => setRegisterPassword(e.target.value)}\r\n        />\r\n        <Button\r\n          type=\"submit\"\r\n          fullWidth\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.submit}\r\n        >\r\n          Sign Up\r\n        </Button>\r\n      </form>\r\n      <Button onClick={switchToLogin} fullWidth variant=\"outlined\" color=\"primary\">\r\n        Cancel\r\n      </Button>\r\n      <Grid container justify=\"flex-end\" style={{ marginTop: '16px' }}>\r\n        <Grid item>\r\n          <Link href=\"#\" variant=\"body2\" onClick={switchToLogin}>\r\n            Already have an account? Sign in\r\n          </Link>\r\n        </Grid>\r\n      </Grid>\r\n    </>\r\n  );\r\n\r\n  const loginContent = () => (\r\n    <>\r\n      <Avatar className={classes.avatar}>\r\n        <LockOutlinedIcon />\r\n      </Avatar>\r\n      <Typography component=\"h1\" variant=\"h5\">\r\n        Sign in\r\n      </Typography>\r\n      <form id=\"login-form\" className={classes.form} onSubmit={handleLogin}>\r\n        <TextField\r\n          variant=\"outlined\"\r\n          margin=\"normal\"\r\n          required\r\n          fullWidth\r\n          name=\"username\"\r\n          label=\"Username\"\r\n          id=\"login-username\"\r\n          autoComplete=\"username\"\r\n          autoFocus\r\n          inputProps={{ minLength: 3, maxLength: 50 }}\r\n          value={loginUsername}\r\n          onChange={(e) => setLoginUsername(e.target.value)}\r\n        />\r\n        <TextField\r\n          variant=\"outlined\"\r\n          margin=\"normal\"\r\n          required\r\n          fullWidth\r\n          name=\"password\"\r\n          label=\"Password\"\r\n          type=\"password\"\r\n          id=\"login-password\"\r\n          autoComplete=\"current-password\"\r\n          inputProps={{ pattern: pwPattern, title: invalidPwMessage }}\r\n          value={loginPassword}\r\n          onChange={(e) => setLoginPassword(e.target.value)}\r\n        />\r\n        <FormControlLabel\r\n          control={<Checkbox value=\"remember\" color=\"primary\" />}\r\n          label=\"Remember me\"\r\n        />\r\n        <Button\r\n          type=\"submit\"\r\n          fullWidth\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.submit}\r\n        >\r\n          Sign In\r\n        </Button>\r\n      </form>\r\n      <Button onClick={handleClose} fullWidth variant=\"outlined\" color=\"primary\">\r\n        Cancel\r\n      </Button>\r\n      <Grid container style={{ marginTop: '16px' }}>\r\n        <Grid item xs>\r\n          <Link href=\"#\" variant=\"body2\" onClick={switchToForgot}>\r\n            Forgot password?\r\n          </Link>\r\n        </Grid>\r\n        <Grid item>\r\n          <Link href=\"#\" variant=\"body2\" onClick={switchToRegister}>\r\n            {\"Don't have an account? Sign Up\"}\r\n          </Link>\r\n        </Grid>\r\n      </Grid>\r\n    </>\r\n  );\r\n\r\n  const logoutContent = () => (\r\n    <>\r\n      <Avatar className={classes.avatar}>\r\n        <PermIdentityOutlinedIcon />\r\n      </Avatar>\r\n      <Typography component=\"h1\" variant=\"h5\">\r\n        Welcome back, <strong>{user}</strong>!\r\n      </Typography>\r\n      <Button\r\n        fullWidth\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        className={classes.submit}\r\n        onClick={handleLogout}\r\n      >\r\n        Logout\r\n      </Button>\r\n      <Button onClick={handleClose} fullWidth variant=\"outlined\" color=\"primary\">\r\n        Cancel\r\n      </Button>\r\n    </>\r\n  );\r\n\r\n  const forgotContent = () => (\r\n    <>\r\n      <Avatar className={classes.avatar}>\r\n        <LockOpenOutlinedIcon />\r\n      </Avatar>\r\n      <Typography component=\"h1\" variant=\"h5\">\r\n        Placeholder for forgot password\r\n      </Typography>\r\n      <form id=\"forgot-form\" className={classes.form} onSubmit={handleForgot}>\r\n        <TextField\r\n          variant=\"outlined\"\r\n          margin=\"normal\"\r\n          required\r\n          fullWidth\r\n          name=\"username\"\r\n          label=\"Username\"\r\n          type=\"username\"\r\n          id=\"forgot-username\"\r\n          autoFocus\r\n          value={forgotUsername}\r\n          onChange={(e) => setForgotUsername(e.target.value)}\r\n        />\r\n        <Button\r\n          type=\"submit\"\r\n          fullWidth\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          className={classes.submit}\r\n        >\r\n          Send reset confirmation\r\n        </Button>\r\n      </form>\r\n      <Button onClick={switchToLogin} fullWidth variant=\"outlined\" color=\"primary\">\r\n        Cancel\r\n      </Button>\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <Dialog\r\n      onEnter={handleSetup}\r\n      open={userDialog.open}\r\n      onClose={() => handleClose()}\r\n      aria-labelledby=\"form-dialog-title\"\r\n    >\r\n      <Container component=\"main\" maxWidth=\"xs\">\r\n        <div className={classes.paper}>{renderContent()}</div>\r\n      </Container>\r\n    </Dialog>\r\n  );\r\n}\r\n","import React from 'react';\r\nimport { Marker } from 'react-map-gl';\r\nimport MarkerIcon from '@material-ui/icons/Room';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setReportDialog, setMarkers, setSnackbar, showSpinner, hideSpinner } from '../actions';\r\nimport { deleteReport } from '../utils/fetch';\r\nimport { RootState } from '../reducers';\r\nimport { Marker as IMarker, CustomMarkerProps } from '../types';\r\n\r\nfunction CustomMarker(props: CustomMarkerProps) {\r\n  const {\r\n    address,\r\n    city,\r\n    postcode,\r\n    description,\r\n    latitude,\r\n    longitude,\r\n    offsetLeft,\r\n    offsetTop,\r\n    reporter,\r\n    subject,\r\n    localIndex,\r\n    dbIndex = null\r\n  } = props;\r\n\r\n  const tool = useSelector((state: RootState) => state.tool);\r\n  const markers = useSelector((state: RootState) => state.markers);\r\n  const dispatch = useDispatch();\r\n\r\n  const handleClick = () => {\r\n    function deleteMarkerLocally() {\r\n      const newMarkers = markers.filter((marker: IMarker, i: number) =>\r\n        i === localIndex ? false : true\r\n      );\r\n      dispatch(setMarkers(newMarkers));\r\n    }\r\n\r\n    if (tool === 'delete') {\r\n      if (!dbIndex) return deleteMarkerLocally();\r\n      // TODO: implement authentication (e.g. AWS Cognito)\r\n      if (reporter !== 'guest')\r\n        return dispatch(\r\n          setSnackbar({\r\n            message: 'Not authorized as guest to delete a report posted by admin.',\r\n            open: true,\r\n            severity: 'warning'\r\n          })\r\n        );\r\n      if (window.confirm('Delete this report?')) {\r\n        dispatch(showSpinner())\r\n        deleteReport({ id: dbIndex })\r\n          .then(() => {\r\n            deleteMarkerLocally();\r\n            dispatch(\r\n              setSnackbar({\r\n                message: 'Report deleted.',\r\n                open: true,\r\n                severity: 'success'\r\n              })\r\n            )\r\n          })\r\n          .catch((err) =>\r\n            dispatch(\r\n              setSnackbar({\r\n                message: err.message,\r\n                open: true,\r\n                severity: 'error'\r\n              })\r\n            )\r\n          ).finally(() => dispatch(hideSpinner()))\r\n      }\r\n    } else {\r\n      dispatch(\r\n        setReportDialog({\r\n          address: address || '---',\r\n          city: city || '---',\r\n          postcode: postcode || '---',\r\n          subject,\r\n          description,\r\n          reporter,\r\n          markerIndex: localIndex,\r\n          latitude,\r\n          longitude,\r\n          open: true\r\n        })\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Marker latitude={latitude} longitude={longitude} offsetLeft={offsetLeft} offsetTop={offsetTop}>\r\n      <div\r\n        style={{ alignItems: 'center', display: 'flex', fontWeight: 'bold', cursor: 'pointer' }}\r\n        onClick={handleClick}\r\n      >\r\n        <MarkerIcon />\r\n        <span>{subject}</span>\r\n      </div>\r\n    </Marker>\r\n  );\r\n}\r\n\r\nexport default CustomMarker;\r\n","import React from 'react';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport MuiAlert, { AlertProps } from '@material-ui/lab/Alert';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { setSnackbar } from '../actions';\r\nimport { RootState } from '../reducers';\r\n\r\nfunction Alert(props: AlertProps) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\n\r\nexport default function CustomSnackbar() {\r\n  const { message, open, severity } = useSelector((state: RootState) => state.snackbar);\r\n  const dispatch = useDispatch();\r\n\r\n  const handleClose = (e?: React.SyntheticEvent, reason?: string) => {\r\n    if (reason === 'clickaway') return;\r\n    dispatch(\r\n      setSnackbar({\r\n        message,\r\n        open: false,\r\n        severity\r\n      })\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Snackbar open={open} autoHideDuration={6000} onClose={handleClose}>\r\n      <Alert onClose={handleClose} severity={severity}>\r\n        {message}\r\n      </Alert>\r\n    </Snackbar>\r\n  );\r\n}\r\n","import { reverseGeocode } from './fetch';\r\nimport { setSnackbar, setMarkers } from '../actions';\r\nimport { Marker } from '../types';\r\nimport { Dispatch } from 'redux';\r\n\r\nconst MAPBOX_TOKEN = process.env.REACT_APP_MAPBOX_TOKEN;\r\n\r\nexport const addNewMarkerLocally = (\r\n  longitude: number,\r\n  latitude: number,\r\n  markers: Marker[],\r\n  dispatch: Dispatch\r\n) => {\r\n  reverseGeocode(\r\n    `https://api.mapbox.com/geocoding/v5/mapbox.places/${longitude},${latitude}.json?access_token=${MAPBOX_TOKEN}`\r\n  )\r\n    .then((res) => {\r\n      const { city, address = '---', postcode = '---', region, country } = res;\r\n      if (country && country !== 'Finland') {\r\n        return dispatch(\r\n          setSnackbar({\r\n            message: `This app is currently restricted to Finland only. Marker location: ${region}, ${country}`,\r\n            open: true,\r\n            severity: 'warning'\r\n          })\r\n        );\r\n      }\r\n\r\n      if (!city) {\r\n        return dispatch(\r\n          setSnackbar({\r\n            message: 'This location is not near a city with infrastructure.',\r\n            open: true,\r\n            severity: 'warning'\r\n          })\r\n        );\r\n      }\r\n\r\n      const newMarker: Marker = {\r\n        address,\r\n        city,\r\n        description: `${address}, ${postcode}, ${city}`,\r\n        id: null,\r\n        latitude,\r\n        longitude,\r\n        postcode,\r\n        reporter: 'guest',\r\n        subject: 'New marker'\r\n      };\r\n\r\n      dispatch(setMarkers([...markers, newMarker]));\r\n    })\r\n    .catch((err) =>\r\n      dispatch(\r\n        setSnackbar({\r\n          message: err.message,\r\n          open: true,\r\n          severity: 'error'\r\n        })\r\n      )\r\n    );\r\n};\r\n","import React, { useEffect, useMemo } from 'react';\nimport ToolDrawer from './components/ToolDrawer';\nimport MapGL from 'react-map-gl';\nimport CustomAppBar from './components/CustomAppBar';\nimport ReportDialog from './components/ReportDialog';\nimport UserDialog from './components/UserDialog';\nimport CustomMarker from './components/CustomMarker';\nimport CustomSnackbar from './components/CustomSnackbar';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setViewport, setMarkers, setSnackbar, hideSpinner } from './actions';\nimport { getAllReports } from './utils/fetch';\nimport { addNewMarkerLocally } from './utils/markers';\nimport CircularProgress from '@material-ui/core/CircularProgress';\n\nimport './App.css';\nimport { makeStyles, ThemeOptions } from '@material-ui/core/styles';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\nimport { purple, blue } from '@material-ui/core/colors';\n\nimport { Marker, Viewport } from './types';\nimport { RootState } from './reducers';\n\nexport const drawerWidth: number = 260;\n\nconst MAPBOX_TOKEN = process.env.REACT_APP_MAPBOX_TOKEN;\n\nconst initialTheme: ThemeOptions = {\n  palette: {\n    primary: purple,\n    secondary: blue,\n    type: 'light'\n  }\n};\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    display: 'flex'\n  },\n  content: {\n    flexGrow: 1,\n    height: '100vh',\n    paddingTop: '56px',\n    overflow: 'hidden'\n  },\n  addToolSelected: {\n    '&>div': {\n      cursor: 'pointer !important'\n    }\n  }\n}));\n\nfunction App() {\n  const muiTheme = createMuiTheme(initialTheme);\n  const classes = useStyles();\n  const markers = useSelector((state: RootState) => state.markers);\n  const viewport = useSelector((state: RootState) => state.viewport);\n  const tool = useSelector((state: RootState) => state.tool);\n  const spinner = useSelector((state: RootState) => state.spinner);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    getAllReports()\n      .then((reports) => dispatch(setMarkers(reports)))\n      .catch((err) =>\n        dispatch(\n          setSnackbar({\n            message: err.message,\n            open: true,\n            severity: 'warning'\n          })\n        )\n      ).finally(() => dispatch(hideSpinner()));\n  }, [dispatch]);\n\n  const handleViewportChange = (viewport: Viewport) => dispatch(setViewport(viewport));\n  const handleClick = async (e: any) => {\n    if (tool === 'add') {\n      // Prioritize edit over add on existing markers\n      if (e.target.tagName !== 'DIV') return;\n      addNewMarkerLocally(e.lngLat[0], e.lngLat[1], markers, dispatch);\n    }\n  };\n\n  return (\n    <ThemeProvider theme={muiTheme}>\n      <div className={classes.root}>\n        <CssBaseline />\n        <ToolDrawer />\n        <CustomAppBar />\n        <main\n          className={\n            tool === 'add' ? `${classes.content} ${classes.addToolSelected}` : classes.content\n          }\n        >\n          <MapGL\n            {...viewport}\n            width=\"100%\"\n            height=\"100%\"\n            mapStyle=\"mapbox://styles/mapbox/streets-v11\"\n            onViewportChange={handleViewportChange}\n            mapboxApiAccessToken={MAPBOX_TOKEN}\n            onMouseDown={handleClick}\n          >\n            {useMemo(\n              () =>\n                markers.map((m: Marker, i: number) => (\n                  <CustomMarker\n                    key={i}\n                    localIndex={i}\n                    address={m.address}\n                    city={m.city}\n                    postcode={m.postcode}\n                    dbIndex={m.id}\n                    longitude={m.longitude}\n                    latitude={m.latitude}\n                    subject={m.subject}\n                    description={m.description}\n                    reporter={m.reporter}\n                    offsetTop={-24}\n                    offsetLeft={-12}\n                  />\n                )),\n              [markers]\n            )}\n          </MapGL>\n          {/* Only rerender when component's state via useSelector changes */}\n          {useMemo(() => <ReportDialog />, [])}\n          {useMemo(() => <UserDialog />, [])}\n          {useMemo(() => <CustomSnackbar />, [])}\n          {spinner && <CircularProgress color=\"secondary\" style={{position: 'absolute', left: '50%', top: '50%', marginLeft: '-20px', marginTop: '-20px'}} />}\n        </main>\n      </div>\n    </ThemeProvider>\n  );\n}\n\nexport default App;\n","import { Action } from 'redux';\r\n\r\nconst drawerReducer = (state: boolean = false, action: Action): boolean => {\r\n    switch(action.type) {\r\n        case 'OPEN-DRAWER':\r\n            return true;\r\n        case 'CLOSE-DRAWER':\r\n            return false;\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default drawerReducer;","import { Viewport, PayloadAction } from '../types';\r\n\r\nconst initialState: Viewport = {\r\n    longitude: 26.2,\r\n    latitude: 62.1,\r\n    zoom: 4.9,\r\n    bearing: 0,\r\n    pitch: 0\r\n}\r\n\r\nconst viewportReducer = (state: Viewport = initialState, action: PayloadAction<Viewport>): Viewport => {\r\n    switch (action.type) {\r\n        case 'VIEWPORT':\r\n            return action.payload;\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default viewportReducer;","import { Tool, PayloadAction } from '../types';\r\n\r\nconst toolReducer = (state: Tool = 'edit', action: PayloadAction<Tool>): Tool => {\r\n    switch (action.type) {\r\n        case 'TOOL':\r\n            return action.payload;\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default toolReducer;","import { Marker, PayloadAction } from '../types';\r\n\r\nconst markerReducer = (state: Marker[] = [], action: PayloadAction<Marker[]>): Marker[] => {\r\n    switch (action.type) {\r\n        case 'MARKERS':\r\n            return action.payload;\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default markerReducer;","import { PayloadAction, Snackbar } from '../types';\r\n\r\nconst initialState: Snackbar = { message: '', open: false, severity: undefined };\r\n\r\nconst snackbarReducer = (\r\n  state = initialState,\r\n  action: PayloadAction<Snackbar>\r\n): Snackbar => {\r\n  switch (action.type) {\r\n    case 'SNACKBAR':\r\n      return action.payload;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport default snackbarReducer;\r\n","import { Action } from 'redux';\r\n\r\nconst spinnerReducer = (state: boolean = true, action: Action): boolean => {\r\n    switch(action.type) {\r\n        case 'SHOW-SPINNER':\r\n            return true;\r\n        case 'HIDE-SPINNER':\r\n            return false;\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default spinnerReducer;","import { PayloadAction, User } from \"../types\";\r\n\r\nconst userReducer = (state: User = null, action: PayloadAction<User>): User => {\r\n    switch (action.type) {\r\n        case 'USER':\r\n            return action.payload;\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default userReducer;","import { ReportDialog, UserDialog, PayloadAction } from '../types';\r\n\r\nconst reportDialogInitialState: ReportDialog = {\r\n  open: false,\r\n  address: '',\r\n  city: '',\r\n  postcode: '',\r\n  subject: '',\r\n  description: '',\r\n  reporter: '',\r\n  markerIndex: 0,\r\n  latitude: 0,\r\n  longitude: 0\r\n};\r\n\r\nexport const reportDialogReducer = (\r\n  state = reportDialogInitialState,\r\n  action: PayloadAction<ReportDialog>\r\n): ReportDialog => {\r\n  switch (action.type) {\r\n    case 'REPORT-DIALOG':\r\n      return action.payload;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nconst userDialogInitialState: UserDialog = {\r\n  open: false,\r\n  mode: 'login'\r\n}\r\n\r\nexport const userDialogReducer = (\r\n  state = userDialogInitialState,\r\n  action: PayloadAction<UserDialog>\r\n): UserDialog => {\r\n  switch (action.type) {\r\n    case 'USER-DIALOG':\r\n      return action.payload;\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import drawerReducer from './drawer';\r\nimport viewportReducer from './viewport';\r\nimport toolReducer from './tool';\r\nimport markerReducer from './markers';\r\nimport snackbarReducer from './snackbar';\r\nimport spinnerReducer from './spinner';\r\nimport userReducer from './user';\r\nimport { reportDialogReducer, userDialogReducer } from './dialog';\r\n\r\nimport { combineReducers, Action } from 'redux';\r\n\r\nconst allReducers = combineReducers({\r\n  reportDialog: reportDialogReducer,\r\n  userDialog: userDialogReducer,\r\n  drawerIsOpen: drawerReducer,\r\n  markers: markerReducer,\r\n  snackbar: snackbarReducer,\r\n  spinner: spinnerReducer,\r\n  tool: toolReducer,\r\n  viewport: viewportReducer,\r\n  user: userReducer\r\n});\r\n\r\nexport const rootReducer = (state: any, action: Action) => {\r\n  if (action.type === 'RESET') {\r\n    state = undefined;\r\n  }\r\n  return allReducers(state, action);\r\n};\r\n\r\nexport type RootState = ReturnType<typeof rootReducer>;\r\n","import { createStore } from 'redux';\r\nimport { rootReducer } from './reducers';\r\n\r\nconst store = createStore(rootReducer);\r\n\r\nexport default store;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport store from './store';\nimport { Provider } from 'react-redux';\nimport Amplify from '@aws-amplify/core';\n\nAmplify.configure({\n  Auth: {\n    mandatorySignIn: true,\n    region: \"us-east-1\",\n    userPoolId: \"us-east-1_i2BfhDyVj\",\n    userPoolWebClientId: \"692191f4kvott1ltrs7i5t4bsi\"\n  }\n});\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}